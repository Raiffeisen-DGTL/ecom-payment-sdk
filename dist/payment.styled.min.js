!function(){"use strict";function e(e,t){for(var n=0;t.length>n;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function t(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function n(){return(n=Object.assign||function(e){for(var t=1;arguments.length>t;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e}).apply(this,arguments)}function r(e,t){e.prototype=Object.create(t.prototype),e.prototype.constructor=e,e.__proto__=t}function o(e,t){return(o=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function i(e,t,n){return(i=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}()?Reflect.construct:function(e,t,n){var r=[null];r.push.apply(r,t);var i=new(Function.bind.apply(e,r));return n&&o(i,n.prototype),i}).apply(null,arguments)}function u(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}var c=function(){function e(){}var t=e.prototype;return t.execute=function(e){void 0===e&&(e={}),this.props=e;var t=this.render();return this.mount=t,this.mount},t.unmount=function(){this.isMount()&&(this.mount.parentNode.removeChild(this.mount),this.mount=null)},t.isMount=function(){return this.mount instanceof HTMLElement},e}(),a=function(e){return(e.getAttribute("class")||"").split(" ").filter(Boolean)},s=function(e,t){var n=a(e);-1===n.indexOf(t)&&(n.push(t),e.setAttribute("class",n.join(" ")))},l=function(e,t){var n=a(e);-1!==n.indexOf(t)&&(n.splice(n.indexOf(t),1),e.setAttribute("class",n.join(" ")))},f="style_root__k59xi",p=function(e){function t(){return e.apply(this,arguments)||this}return r(t,e),t.prototype.render=function(){var e=this.props,t=e.children,n=e.onClick,r=document.createElement("div");return s(r,f),r.addEventListener("click",n),r.appendChild(t),r},t}(c),d="style_cover__352rz",m="style_wrap__r6QoJ",h="style_cross__Dq62T",v="style_inner__1WMoI",y="style_iframe__2XtWY",_=function(n){function o(){for(var e,r=arguments.length,o=Array(r),i=0;r>i;i++)o[i]=arguments[i];return t(u(e=n.call.apply(n,[this].concat(o))||this),"name","payment-page"),t(u(e),"handleClickCross",(function(t){t.stopPropagation(),(0,e.props.onForceClose)()})),e}var i,c,a;return r(o,n),o.prototype.render=function(){var e=this.props.onClose,t=new p,n=document.createElement("div");s(n,d);var r=document.createElement("div");s(r,h),r.addEventListener("click",this.handleClickCross),r.innerText="✕";var o=document.createElement("div");s(o,m);var i=document.createElement("div");s(i,v);var u=document.createElement("iframe");return u.setAttribute("name",this.name),s(u,y),n.appendChild(o),o.appendChild(r),o.appendChild(i),i.appendChild(u),t.execute({children:n,onClick:e})},i=o,(c=[{key:"url",get:function(){var e=this.props.url,t=e.indexOf("?");return-1===t?e:e.slice(0,t)}}])&&e(i.prototype,c),a&&e(i,a),o}(c),b="style_button__1YfrP",g="style_active__21G-H",w=function(e){function t(){return e.apply(this,arguments)||this}return r(t,e),t.prototype.render=function(){var e=this.props,t=e.isActive,n=e.onClick,r=e.children,o=document.createElement("button");return o.addEventListener("click",n),o.innerText=r,s(o,b),t&&s(o,g),o},t}(c),C="style_confirm-panel__1s25-",P="style_button-wrap__1Rcd5",E="style_label__wJvJQ",j=function(e){function t(){return e.apply(this,arguments)||this}return r(t,e),t.prototype.render=function(){var e=this.props,t=e.onClose,n=e.onCancel,r=new p,o=document.createElement("div");s(o,C);var i=document.createElement("div");i.innerText="Вы уверены, что хотите закрыть окно?",s(i,E);var u=document.createElement("div");s(u,P);var c=new w,a=new w;return o.appendChild(i),o.appendChild(u),u.appendChild(c.execute({onClick:t,isActive:!0,children:"Закрыть"})),u.appendChild(a.execute({onClick:n,children:"Отмена"})),r.execute({children:o})},t}(c),O=function(e){window.location.replace(e)};function k(e){var t=this.constructor;return this.then((function(n){return t.resolve(e()).then((function(){return n}))}),(function(n){return t.resolve(e()).then((function(){return t.reject(n)}))}))}var x=setTimeout;function F(e){return!(!e||void 0===e.length)}function A(){}function T(e){if(!(this instanceof T))throw new TypeError("Promises must be constructed via new");if("function"!=typeof e)throw new TypeError("not a function");this._state=0,this._handled=!1,this._value=void 0,this._deferreds=[],J(e,this)}function R(e,t){for(;3===e._state;)e=e._value;0!==e._state?(e._handled=!0,T._immediateFn((function(){var n=1===e._state?t.onFulfilled:t.onRejected;if(null!==n){var r;try{r=n(e._value)}catch(e){return void M(t.promise,e)}I(t.promise,r)}else(1===e._state?I:M)(t.promise,e._value)}))):e._deferreds.push(t)}function I(e,t){try{if(t===e)throw new TypeError("A promise cannot be resolved with itself.");if(t&&("object"==typeof t||"function"==typeof t)){var n=t.then;if(t instanceof T)return e._state=3,e._value=t,void B(e);if("function"==typeof n)return void J((r=n,o=t,function(){r.apply(o,arguments)}),e)}e._state=1,e._value=t,B(e)}catch(t){M(e,t)}var r,o}function M(e,t){e._state=2,e._value=t,B(e)}function B(e){2===e._state&&0===e._deferreds.length&&T._immediateFn((function(){e._handled||T._unhandledRejectionFn(e._value)}));for(var t=0,n=e._deferreds.length;n>t;t++)R(e,e._deferreds[t]);e._deferreds=null}function L(e,t,n){this.onFulfilled="function"==typeof e?e:null,this.onRejected="function"==typeof t?t:null,this.promise=n}function J(e,t){var n=!1;try{e((function(e){n||(n=!0,I(t,e))}),(function(e){n||(n=!0,M(t,e))}))}catch(e){if(n)return;n=!0,M(t,e)}}T.prototype.catch=function(e){return this.then(null,e)},T.prototype.then=function(e,t){var n=new this.constructor(A);return R(this,new L(e,t,n)),n},T.prototype.finally=k,T.all=function(e){return new T((function(t,n){if(!F(e))return n(new TypeError("Promise.all accepts an array"));var r=Array.prototype.slice.call(e);if(0===r.length)return t([]);var o=r.length;function i(e,u){try{if(u&&("object"==typeof u||"function"==typeof u)){var c=u.then;if("function"==typeof c)return void c.call(u,(function(t){i(e,t)}),n)}r[e]=u,0==--o&&t(r)}catch(e){n(e)}}for(var u=0;r.length>u;u++)i(u,r[u])}))},T.resolve=function(e){return e&&"object"==typeof e&&e.constructor===T?e:new T((function(t){t(e)}))},T.reject=function(e){return new T((function(t,n){n(e)}))},T.race=function(e){return new T((function(t,n){if(!F(e))return n(new TypeError("Promise.race accepts an array"));for(var r=0,o=e.length;o>r;r++)T.resolve(e[r]).then(t,n)}))},T._immediateFn="function"==typeof setImmediate&&function(e){setImmediate(e)}||function(e){x(e,0)},T._unhandledRejectionFn=function(e){void 0!==console&&console&&console.warn("Possible Unhandled Promise Rejection:",e)};var N=function(){if("undefined"!=typeof self)return self;if("undefined"!=typeof window)return window;if("undefined"!=typeof global)return global;throw Error("unable to locate global object")}();"Promise"in N?N.Promise.prototype.finally||(N.Promise.prototype.finally=k):N.Promise=T;var S,U,W="style_body-scroll-disable__4o99q",D=(S=function(e,r){var o,i=this;void 0===r&&(r={}),t(this,"closePopup",(function(e){return function(){i.confirm&&i.confirm.isMount()||!i.paymentPage||!i.paymentPage.isMount()||(i.confirm=new j,i.mount.appendChild(i.confirm.execute({onClose:i.forceClosePopup(e),onCancel:function(){return i.confirm.unmount()}})))}})),t(this,"forceClosePopup",(function(e){return function(){i.paymentPage&&i.paymentPage.unmount(),i.confirm&&i.confirm.unmount(),window.removeEventListener("message",i.messageBinding),i.messageBinding=null,function(){l(document.body,W);var e=document.getElementsByTagName("html")[0];l(e,W)}(),"function"==typeof e&&e()}})),t(this,"submitForm",(function(e,t){void 0===e&&(e="_self");var n=document.createElement("form");n.setAttribute("action",i.url),n.setAttribute("method","POST"),n.setAttribute("target",e),Object.keys(t).forEach((function(e){var r=document.createElement("input"),o=function(e){if(e instanceof Object)try{return JSON.stringify(e)}catch(e){return""}return e}(t[e]);r.setAttribute("value",o),r.setAttribute("name",e),n.appendChild(r)})),i.mount.appendChild(n),n.submit(),i.mount.removeChild(n)})),t(this,"openPopup",(function(e,t){return void 0===t&&(t={}),new Promise((function(r,o){if(!(i.paymentPage&&i.paymentPage.isMount()&&i.messageBinding)){var u,c,a,l=n({},t,{publicId:i.publicId,style:i.style,version:i.version,amount:e,successUrl:"#",failUrl:"#"});i.paymentPage=new _,i.mount.appendChild(i.paymentPage.execute({onClose:i.closePopup((function(){return o({isCrossClose:!0})})),onForceClose:i.forceClosePopup((function(){return o({isCrossClose:!0})})),url:i.url})),i.messageBinding=(u=window,c={finish:i.handleFinishPayment(r,o,t.successUrl,t.failUrl)},u.addEventListener("message",a=function(e){if(e&&e.data){var t=JSON.parse(e.data);t.event&&"function"==typeof c[t.event]&&c[t.event](t.content)}},!1),a),i.submitForm(i.paymentPage.name,l),function(){s(document.body,W);var e=document.getElementsByTagName("html")[0];s(e,W)}()}}))})),t(this,"openWindow",(function(e){var t=n({publicId:i.publicId,version:i.version},e);i.submitForm("_blank",t)})),t(this,"replace",(function(e){var t=n({publicId:i.publicId,version:i.version},e);i.submitForm("_self",t)})),t(this,"handleFinishPayment",(function(e,t,n,r){return function(o){"success"===o.result&&(e(),n)?O(n):"failed"===o.result&&(t({isCrossClose:!1}),r)?O(r):i.forceClosePopup()()}})),this.mount=r.targetElem instanceof HTMLElement?r.targetElem:document.body,this.publicId=e,this.style=r.style,this.version="1.1.6",this.url="/"!==(o=r.url)[o.length-1]?o:o.slice(0,o.length-1)},U=null,function(){function e(){for(var e=arguments.length,t=Array(e),n=0;e>n;n++)t[n]=arguments[n];U=i(S,t)}var t=e.prototype;return t.openPopup=function(){var e;return(e=U).openPopup.apply(e,arguments)},t.openWindow=function(){var e;return(e=U).openWindow.apply(e,arguments)},t.replace=function(){var e;return(e=U).replace.apply(e,arguments)},e}());window.PaymentPageSdk=D}();
